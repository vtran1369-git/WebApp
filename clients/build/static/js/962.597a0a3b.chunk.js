"use strict";(self.webpackChunkclients=self.webpackChunkclients||[]).push([[962],{48171:function(e,t,n){n(72791);var r=n(80184);t.Z=function(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{children:(0,r.jsx)("button",{style:{height:"28px"},onClick:function(){return window.location.reload()},children:"Back To Listing Page"})})})}},8430:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(50678),a=n(72791);function c(e,t){var n=a.useState((function(){return JSON.parse(localStorage.getItem(e))||t})),c=(0,r.Z)(n,2),o=c[0],s=c[1];return(0,a.useEffect)((function(){localStorage.setItem(e,JSON.stringify(o))}),[e,o]),[o,s]}},74541:function(e,t,n){var r=n(27166),a=n(33032),c=n(84791),o=n(35493);function s(){return(s=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.Z.get("/mfccal/cert/getcert/".concat(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function i(){return(i=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",c.Z.get("/mfccal/cert/getreport/".concat(t)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.Z={getAll:function(e){return c.Z.get("/mfccal/all/".concat(e))},getLimitAll:function(e){return c.Z.post("/mfccal/limitall",{data:e,headers:(0,o.Z)()})},getById:function(e){return c.Z.get("/mfccal/onebyid/".concat(e))},create:function(e){return c.Z.post("/mfccal",e)},update:function(e,t){return c.Z.put("/mfccal/update/".concat(e),t)},remove:function(e){return c.Z.delete("/mfccal/".concat(e))},removeAll:function(){return c.Z.delete("/mfccal")},findByName:function(e){return c.Z.get("/mfccal?name=".concat(e))},getCertByID:function(e){return s.apply(this,arguments)},getDataReportByID:function(e){return i.apply(this,arguments)},getAllEquipCal:function(){return c.Z.get("mfccal/cert/equipment/all")},updateEquipCal:function(e,t){return c.Z.put("/mfccal/cert/equipment/update/".concat(e),t)},loadCert:function(e){return c.Z.get("/mfccal/cert/equipment/download/".concat(e),{responseType:"arraybuffer",headers:{"Content-Type":"application/json",Accept:"application/pdf"}})},getByWO:function(e){return c.Z.post("/mfccal/getByWO",{data:e})},getBySN:function(e){return console.log("data from getBySN IS ".concat(e)),c.Z.post("/mfccal/getBySN",{data:e})}}},35493:function(e,t,n){function r(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.accessToken?{"x-access-token":e.accessToken}:{}}n.d(t,{Z:function(){return r}})},84791:function(e,t,n){var r=n(13123);t.Z=r.Z.create({baseURL:"http://localhost:3000/api"}),console.log("env: ","http://localhost:3000/api")},8962:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var r=n(27166),a=n(33032),c=n(50678),o=n(72791),s=n(71358),i=n(79271),l=n(74541),u=(n(87705),n(68639),n(21609)),d=(n(84791),n(80184));var g=n(31303),p=n(18489),f=n(83738),h=n(91523),m=["indeterminate"];var x=function(e){var t=e.columns,n=e.data,r=e.fetchData,a=e.loading,c=e.pageCount,i=e.onclick,l=e.handlePrintCert,u=o.useMemo((function(){return{Filter:x}}),[]);function x(e){var t=e.column,n=t.filterValue,r=t.preFilteredRows,a=t.setFilter,c=r.length;return(0,d.jsx)("input",{value:n||"",onChange:function(e){a(e.target.value||void 0)},placeholder:"Search ".concat(c," records...")})}var Z=o.forwardRef((function(e,t){var n=e.indeterminate,r=(0,f.Z)(e,m),a=o.useRef(),c=t||a;return o.useEffect((function(){c.current.indeterminate=n}),[c,n]),(0,d.jsx)(d.Fragment,{children:(0,d.jsx)("input",(0,p.Z)({type:"checkbox",ref:c},r))})})),j=(0,s.useTable)({columns:t,data:n,defaultColumn:u,initialState:{pageIndex:0,pageSize:20},manualPagination:!0,pageCount:c,autoResetFilter:!1,autoResetPage:!1},s.useFilters,s.useSortBy,s.usePagination,s.useRowSelect,(function(e){e.visibleColumns.push((function(e){return[{id:"selection",Header:(0,d.jsx)("div",{children:"PrintCert"}),Cell:function(e){var t=e.row;return(0,d.jsx)("div",{children:(0,d.jsx)(Z,(0,p.Z)({},t.getToggleRowSelectedProps()))})}}].concat((0,g.Z)(e))}))})),v=j.getTableProps,S=j.getTableBodyProps,C=j.headerGroups,y=j.prepareRow,b=j.page,I=j.canPreviousPage,k=j.canNextPage,w=j.pageOptions,P=j.pageCount,R=j.gotoPage,D=j.nextPage,N=j.previousPage,B=j.setPageSize,L=j.state,F=L.pageIndex,T=L.pageSize;(0,o.useEffect)((function(){r({pageIndex:F,pageSize:T})}),[F,T]);var O=function(){return(0,d.jsxs)("div",{className:"pagination",children:[(0,d.jsx)("button",{onClick:function(){return R(0)},disabled:!I,children:"<<"})," ",(0,d.jsx)("button",{onClick:function(){return N()},disabled:!I,children:"<"})," ",(0,d.jsx)("button",{onClick:function(){return D()},disabled:!k,children:">"})," ",(0,d.jsx)("button",{onClick:function(){return R(P-1)},disabled:!k,children:">>"})," ",(0,d.jsxs)("span",{children:["Page"," ",(0,d.jsxs)("strong",{children:[F+1," of ",w.length]})," "]}),(0,d.jsxs)("span",{style:{width:"300px"},children:["| Go to page:"," ",(0,d.jsx)("input",{type:"number",defaultValue:F+1,onChange:function(e){var t=e.target.value?Number(e.target.value)-1:0;R(t)},style:{width:"100px"}})]})," ",(0,d.jsx)("select",{value:T,onChange:function(e){B(Number(e.target.value))},children:[20,40,60,70,90,100].map((function(e){return(0,d.jsxs)("option",{value:e,children:["Show ",e]},e)}))})]})},H=function(){return(0,d.jsx)("tr",{children:a?(0,d.jsx)("td",{colSpan:"10000",children:"Loading..."}):(0,d.jsxs)("td",{colSpan:"10000",children:["Showing ",b.length," of ~",c*T," ","results"]})})};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(O,{}),(0,d.jsxs)("table",(0,p.Z)((0,p.Z)({},v()),{},{children:[(0,d.jsx)(H,{}),(0,d.jsx)("thead",{children:C.map((function(e){return(0,d.jsx)("tr",(0,p.Z)((0,p.Z)({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e){return(0,d.jsxs)("th",(0,p.Z)((0,p.Z)({},e.getHeaderProps(e.getSortByToggleProps())),{},{className:e.isSorted?e.isSortedDesc?"sort-desc":"sort-asc":"",children:[e.render("Header"),(0,d.jsx)("div",{className:"filter",children:e.canFilter?e.render("Filter"):null})]}))}))}))}))}),(0,d.jsxs)("tbody",(0,p.Z)((0,p.Z)({},S()),{},{children:[b.map((function(e,t){return y(e),(0,d.jsx)("tr",(0,p.Z)((0,p.Z)({},e.getRowProps()),{},{className:"tr ".concat(e.isSelected?"selected":""),onChange:function(){return function(e,t){e.toggleRowSelected(!1),!e.isSelected&&l(t)}(e,e.original.CalID)},children:e.cells.map((function(t,n){return(0,d.jsx)("td",(0,p.Z)((0,p.Z)({},t.getCellProps()),{},{children:1===n?(0,d.jsx)(h.rU,{onClick:function(){return i(e.original.CalID)},children:t.value?t.render("Cell"):"Add WO"}):t.render("Cell")}))}))}))})),(0,d.jsx)(H,{})]}))]})),(0,d.jsx)(O,{})]})},Z=n(1288),j=n(8430),v=n(3643),S=n(48171);function C(e){var t=o.useState([]),n=(0,c.Z)(t,2),s=n[0],g=n[1],p=o.useState(!1),f=(0,c.Z)(p,2),h=f[0],m=f[1],C=o.useState(0),y=(0,c.Z)(C,2),b=y[0],I=y[1],k=o.useRef(0),w=(0,o.useState)(!1),P=(0,c.Z)(w,2),R=P[0],D=P[1],N=(0,o.useState)(null),B=(0,c.Z)(N,2),L=B[0],F=B[1],T=(0,o.useRef)(null),O=(0,j.Z)("cdm",[]),H=(0,c.Z)(O,2),A=H[0],z=H[1],W=(0,j.Z)("pages",0),E=(0,c.Z)(W,2),G=E[0],M=E[1],q=(0,j.Z)("pageindex",0),_=(0,c.Z)(q,2),U=_[0],J=_[1],V=o.useMemo((function(){return[{Header:"Work Order",accessor:"WOnum"},{Header:"SN",accessor:"SN"},{Header:"Cal.Date",accessor:"CalDTG"},{Header:"Operator",accessor:"Operator"},{Header:"Customer",accessor:"Customer"},{Header:"Customer Location",accessor:"Customer Location"},{Header:"DUT",accessor:"DUT"},{Header:"Gas/Range",accessor:"GasRange"}]})),K=(0,i.k6)(),Q=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Promise.all([l.Z.getCertByID(t),l.Z.getDataReportByID(t)]).then((function(e){var n=e[0].data.data,r=e[1].data.data;K.push("/mfccal/cert",{id:t,certdata:n,reportdata:r}),T.current="CertReport"}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=o.useCallback((function(e){var t=e.pageSize,n=e.pageIndex,r=++k.current;console.log("fetchdata called: ",r),m(!0),setTimeout((function(){r===k.current&&(console.log("fetchID = fetchIdRef"),A.length>0&&n===U?(g(A),I(parseInt(G))):(console.log("fetchID != fetchIdRef"),console.log("persistadata is empty, then fetching database"),l.Z.getLimitAll({pageIndex:n,pageSize:t}).then((function(e){console.log("fetching CDM List: ",e.data.message);var t=e.data.cdmList;g(t),I(parseInt(e.data.pages)),z(t),M(e.data.pages),J(n)}),(function(e){console.log("error: ",e);var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();D(!0),F(t),console.log("_content: ",t)}))),m(!1))}),1e3)}),[]),Y=function(){console.log("handleREfreshing"),(0,v.removeLocalCDMList)();l.Z.getLimitAll({pageIndex:0,pageSize:20}).then((function(e){var t=e.data.cdmList;g(t),I(parseInt(e.data.pages)),z(t),M(e.data.pages),J(0)}),(function(e){console.log("error: ",e);var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();D(!0),F(t),console.log("_content: ",t)}))},$=function(){var e=(0,o.useRef)(null);return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(Z.Z,{container:!0,xs:12,spacing:"2",children:[(0,d.jsx)(Z.Z,{item:!0,xs:5,children:(0,d.jsx)("button",{style:{height:"28px",marginLeft:"5px"},onClick:Y,children:"Refreshing Data"})}),(0,d.jsx)(Z.Z,{item:!0,xs:"4",children:(0,d.jsx)("input",{type:"text",name:"wo",ref:e,placeholder:"Search by WO"})}),(0,d.jsx)(Z.Z,{item:!0,xs:3,children:(0,d.jsx)("button",{style:{height:"28px"},onClick:function(){var t=e.current.value;l.Z.getByWO({pageIndex:0,pageSize:20,wo:t}).then((function(e){var t=e.data.cdmList;g(t),I(parseInt(e.data.pages))}),(function(e){console.log("error: ",e);var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();D(!0),F(t),console.log("_content: ",t)}))},children:"Search"})})]})})},ee=function(){var e=(0,o.useRef)(null);return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(Z.Z,{container:!0,xs:12,spacing:"2",children:[(0,d.jsx)(Z.Z,{item:!0,xs:"5",children:(0,d.jsx)("div",{children:(0,d.jsx)("input",{type:"text",name:"sn",ref:e,placeholder:"Search by SN"})})}),(0,d.jsx)(Z.Z,{item:!0,xs:3,children:(0,d.jsx)("button",{style:{height:"28px"},onClick:function(){var t=e.current.value;console.log("sn#: ",t);l.Z.getBySN({pageIndex:0,pageSize:20,sn:t}).then((function(e){var t=e.data.cdmList;console.log("search return: ",t),g(t),I(parseInt(e.data.pages))}),(function(e){console.log("error: ",e);var t=e.response&&e.response.data&&e.response.data.message||e.message||e.toString();D(!0),F(t),console.log("_content: ",t)}))},children:"Search"})})]})})};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(u.Z,{name:"Calibration Data Management"}),(0,d.jsx)(Z.Z,{item:!0,xs:12,className:"App-tbl",children:R?(0,d.jsx)("div",{children:L}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(Z.Z,{container:!0,xs:12,spacing:2,direction:"row",className:"cdm-menubar",style:{marginLeft:"15px",marginBottom:"0px",height:"45px"},children:[(0,d.jsx)(Z.Z,{item:!0,xs:5,children:(0,d.jsx)($,{})}),(0,d.jsx)(Z.Z,{item:!0,xs:4,children:(0,d.jsx)(ee,{})}),(0,d.jsx)(Z.Z,{item:!0,xs:2,children:(0,d.jsx)(S.Z,{})})]}),(0,d.jsx)("div",{children:(0,d.jsx)(x,{columns:V,data:s,fetchData:X,loading:h,pageCount:b,onclick:function(e){try{l.Z.getById(e).then((function(t){var n=t.data.mfc_cal;K.push("/mfccal/detail",{data:n,id:e}),T.current="MFCCal"}))}catch(R){console.log(R)}},handlePrintCert:Q})})]})})]})}},21609:function(e,t,n){var r=n(80184);t.Z=function(e){return(0,r.jsx)("div",{className:"form-header",style:{textAlign:"center"},children:(0,r.jsx)("h1",{children:e.name})})}},68639:function(){}}]);
//# sourceMappingURL=962.597a0a3b.chunk.js.map